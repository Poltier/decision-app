<div class="profile-container">
    <div class="avatar-selection">
      <div *ngFor="let avatar of avatars" (click)="selectAvatar(avatar)">
        <img [src]="avatar" [class.selected]="avatar === selectedAvatar">
      </div>
    </div>
  
    <form [formGroup]="profileForm" (ngSubmit)="updateProfile()" class="profile-form">
      <!-- Email input -->
      <mat-form-field appearance="fill" class="profile-field">
        <mat-label>New Email</mat-label>
        <input matInput formControlName="email" type="email">
      </mat-form-field>
  
      <!-- New Password input -->
      <mat-form-field appearance="fill" class="profile-field">
        <mat-label>New Password</mat-label>
        <input matInput formControlName="newPassword" type="password">
      </mat-form-field>
  
      <button mat-raised-button color="primary" type="submit">Update Profile</button>
    </form>
  
    <div *ngIf="userQuestions.length > 0; else noQuestions">
        <table class="user-questions">
          <thead>
            <tr>
              <th>Question</th>
              <th>Correct Option</th>
              <th>Incorrect Option</th>
              <th>Image</th>
              <th>Creation Date</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let question of userQuestions">
              <td>{{ question.questionText }}</td>
              <td>{{ getCorrectOptionText(question.options) }}</td>
              <td>{{ getIncorrectOptionText(question.options) }}</td>
              <td><a href="{{ question.imageUrl }}" target="_blank">View Image</a></td>
              <td>{{ question.createdAt }}</td>
              <td>{{ question.approved ? 'Approved' : 'Pending' }}</td>
              <td>
                <button *ngIf="!question.approved && isEditing ==false" mat-button (click)="editQuestion(question)">Edit</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

    <div *ngIf="isEditing">
        <form [formGroup]="questionForm" (ngSubmit)="saveEditedQuestion()">
            <div>
                <label for="questionText">Question</label>
                <input type="text" id="questionText" formControlName="questionText">
              </div>
              <div>
                <label for="imageUrl">Image URL</label>
                <input type="text" id="imageUrl" formControlName="imageUrl">
              </div>
              <div>
                <label for="option1">Option 1</label>
                <input type="text" id="option1" formControlName="option1">
              </div>
              <div>
                <label for="option2">Option 2</label>
                <input type="text" id="option2" formControlName="option2">
              </div>
              <div>
                <label for="correctOption">Correct Option</label>
                <select id="correctOption" formControlName="correctOption">
                  <option value="option1">Option 1</option>
                  <option value="option2">Option 2</option>
                </select>
              </div>
            <button *ngIf="isEditing" mat-raised-button color="accent" (click)="saveEditedQuestion()">Save</button>
            <button *ngIf="isEditing" mat-raised-button color="warn" (click)="cancelEdit()">Discard</button>
        </form>
    </div>

    <ng-template #noQuestions>
      <p>You have not submitted any questions.</p>
    </ng-template>
  </div>
  
